# /etc/ssh/sshd_config

# Listen
AddressFamily inet
ListenAddress 0.0.0.0
Port 22

# Protocol
Protocol 2
UseDNS no

# Ciphers
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com
HostKeyAlgorithms ssh-ed25519,rsa-sha2-512,rsa-sha2-256
KexAlgorithms sntrup761x25519-sha512@openssh.com,curve25519-sha256

# User
AllowUsers ubuntu
PermitRootLogin no

# Banner
Banner /etc/ssh/banner
PrintLastLog yes
PrintMotd yes

# Authentication
AuthorizedKeysFile %h/.ssh/authorized_keys
ChallengeResponseAuthentication no
ClientAliveInterval 30
ClientAliveCountMax 2
DebianBanner no
FingerprintHash sha256
GSSAPIAuthentication no
GSSAPICleanupCredentials yes
HostbasedAuthentication no
KbdInteractiveAuthentication no
KerberosAuthentication no
KerberosOrLocalPasswd no
KerberosTicketCleanup yes
LoginGraceTime 30
PasswordAuthentication no
PubkeyAuthentication yes
UsePAM yes

# Forwarding
AllowAgentForwarding no
AllowStreamLocalForwarding no
AllowTcpForwarding no
GatewayPorts no
PermitTunnel no

# Hardening Tweaks
Compression no
DisableForwarding yes
IgnoreRhosts yes
IgnoreUserKnownHosts yes
MaxAuthTries 3
MaxSessions 10
MaxStartups 10:51:15
PermitEmptyPasswords no
PermitUserEnvironment no
StrictModes yes
TCPKeepAlive yes
VersionAddendum none
X11Forwarding no

# Hostkey
HostKey /etc/ssh/ssh_host_ed25519_key
HostKey /etc/ssh/ssh_host_rsa_key

# Logging
LogLevel VERBOSE
SyslogFacility AUTH

# PID
PidFile /run/sshd.pid

# Subsystems
# Subsystem sftp internal-sftp
